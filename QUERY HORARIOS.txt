SELECT 
	CAST(HORARIOS.FECHA AS varchar), 
	CAST(EMPLEADO.ID AS varchar) as [CODIGO],
	EMPLEADO.PUESTO,
	EMPLEADO.NOMBRE, 
	EMPLEADO.APELLIDO,
	CAST(HORARIOS.ENTRADA AS varchar), 
	CAST(HORARIOS.SALIDA AS varchar) 
FROM (
	SELECT ENTRADA.EMPE_IDENTITY, ENTRADA.FECHA, CONVERT(VARCHAR,ENTRADA.HORA,22)[ENTRADA], CONVERT(VARCHAR,SALIDA.HORA,22)[SALIDA] FROM (
		SELECT 
			MARK_IDENTITY, 
			EMPE_IDENTITY, 
			FECHA, 
			HORA 
		FROM MARK 
		WHERE MARK_IDENTITY IN (
			SELECT 
				MIN(MARK_IDENTITY) MINIMO 
			FROM MARK
			GROUP BY EMPE_IDENTITY, FECHA
		)
	)AS ENTRADA
	JOIN(
		SELECT 
			MARK_IDENTITY, 
			EMPE_IDENTITY, 
			FECHA, 
			HORA 
		FROM MARK 
		WHERE MARK_IDENTITY IN (
			SELECT 
				MAX(MARK_IDENTITY) MINIMO 
			FROM MARK
			GROUP BY EMPE_IDENTITY, FECHA
		)
	)AS SALIDA
	ON(
		SALIDA.EMPE_IDENTITY = ENTRADA.EMPE_IDENTITY
		AND SALIDA.FECHA = ENTRADA.FECHA
	)
)AS HORARIOS
JOIN(
	SELECT * FROM EMPLEADO
)AS EMPLEADO
ON(HORARIOS.EMPE_IDENTITY = EMPLEADO.ID)